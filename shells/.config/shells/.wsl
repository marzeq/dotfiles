#!/usr/bin/env bash

# if not running in WSL, don't do anything
if [ ! -n "$WSL_DISTRO_NAME" ]; then
  return
fi

command_not_found_handle() {
  local cmd="$1"
  shift

  if command -v "${cmd}.exe" >/dev/null 2>&1; then
    "${cmd}.exe" "$@"
  else
    echo "$cmd: command not found"
    return 127
  fi
}

# for zsh compatibility
command_not_found_handler() {
  command_not_found_handle "$@"
}

winhome() {
  echo $(wslpath $(wslvar "USERPROFILE"))
}

wincd() {
  if [ "$#" -eq 0 ]; then
    LOC=$(winhome)
  else
    LOC=$(wslpath ${1})
  fi

  cd "$LOC"
}

# check if cwd matches regex /\/mnt\/.\/?.*/. , if so, cd to ~
if [[ "$PWD" =~ /mnt/[a-z]/?.* ]]; then
  cd ~
fi
